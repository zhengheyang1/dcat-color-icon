<?php
namespace Zhy\ColorfulIcon\Extensions\Form;

use Dcat\Admin\Form\Field\Text;

class ColorIcon extends Text{

    public static $js = [
        'vendor/dcat-admin-extensions/zhy/colorful-icon/js/fontawesome-iconpicker.js',
    ];
    public static $css = [
        'vendor/dcat-admin-extensions/zhy/colorful-icon/css/fontawesome-iconpicker.css'
    ];

    public function render()
    {
        $this->addScript();

        $this->prepend("<svg class='icon' aria-hidden='true'><use xlink:href='{$this->value()}'></use></svg>")
            ->defaultAttribute('autocomplete', 'off')
            ->defaultAttribute('style', 'width: 160px;flex:none');

        return parent::render();
    }


    protected function addScript()
    {
        $this->script = <<<JS
setTimeout(function () {
    var field = $('{$this->getElementClassSelector()}'),
        parent = field.parents('.form-field'),
        showIcon = function (icon) {
            parent.find('.input-group-prepend .input-group-text').html('<svg class="icon" aria-hidden="true"><use xlink:href="'+icon+'"></use></svg>');

        };

    const arr = ["#icon-xiangmuchuangjian","#icon-xiangmuchuangjian","#icon-xiangmujingdugenzong","#icon-xiangmujingdugenzong","#icon-faxian","#icon-faxian","#icon-yezhugoutong","#icon-yezhugoutong","#icon-xiangmubiangeng","#icon-xiangmubiangeng","#icon-qianyueguidang","#icon-qianyueguidang","#icon-takanshenqing","#icon-takanshenqing","#icon-hetongzhunbei","#icon-hetongzhunbei","#icon-xindiankaiye","#icon-xindiankaiye","#icon-xiangmuzhunbei","#icon-xiangmuzhunbei","#icon-ganxiren","#icon-ganxiren","#icon-xiangmulixiang","#icon-xiangmulixiang","#icon-shigongwentifankui","#icon-shigongwentifankui","#icon-jiechangshigong","#icon-jiechangshigong","#icon-shigongqianzhunbei","#icon-shigongqianzhunbei","#icon-jungongyanshou","#icon-jungongyanshou","#icon-yijiaoyingyun","#icon-yijiaoyingyun","#icon-pingmiantusheji","#icon-pingmiantusheji","#icon-tuzhipaian","#icon-tuzhipaian","#icon-yusuan","#icon-yusuan","#icon-takanqueren","#icon-takanqueren","#icon-gongchengtakan","#icon-gongchengtakan","#icon-dingdanshouhuo","#icon-dingdanshouhuo","#icon-shigongtusheji","#icon-shigongtusheji","#icon-shigongrizhi","#icon-shigongrizhi","#icon-dingdanfahuo","#icon-dingdanfahuo","#icon-dingdanchuangjian","#icon-dingdanchuangjian","#icon-juesuan","#icon-juesuan","#icon-shigongpaian","#icon-shigongpaian","#icon-xiaoguotusheji","#icon-xiaoguotusheji","#icon-dingdanqueren","#icon-dingdanqueren","#icon-shigongwentichuli","#icon-shigongwentichuli","#icon-1","#icon-1","#icon-exe","#icon-exe","#icon-audio","#icon-audio","#icon-css","#icon-css","#icon-html","#icon-html","#icon-md","#icon-md","#icon-js","#icon-js","#icon-image","#icon-image","#icon-MP3","#icon-MP3","#icon-excel","#icon-excel","#icon-JSON","#icon-JSON","#icon-ppt","#icon-ppt","#icon-pdf","#icon-pdf","#icon-sql","#icon-sql","#icon-PSD","#icon-PSD","#icon-PHP","#icon-PHP","#icon-txt","#icon-txt","#icon-svg","#icon-svg","#icon-vue","#icon-vue","#icon-video","#icon-video","#icon-word","#icon-word","#icon-baoxiu","#icon-baoxiu","#icon-danganguanli","#icon-danganguanli","#icon-jibeiziyuan","#icon-jibeiziyuan","#icon-dianming","#icon-dianming","#icon-cankaodaan","#icon-cankaodaan","#icon-kaoqin","#icon-kaoqin","#icon-jiaxiaogoutong","#icon-jiaxiaogoutong","#icon-fuwuzhongxin","#icon-fuwuzhongxin","#icon-touxiangguanli","#icon-touxiangguanli","#icon-tongzhi","#icon-tongzhi","#icon-qingjia","#icon-qingjia","#icon-tousujianyi","#icon-tousujianyi","#icon-wodejiangyi","#icon-wodejiangyi","#icon-yikatong","#icon-yikatong","#icon-jiaofeizhongxin","#icon-jiaofeizhongxin","#icon-xiaoyuananquan","#icon-xiaoyuananquan","#icon-ziyuanzhongxin","#icon-ziyuanzhongxin","#icon-zuoye","#icon-zuoye","#icon-yuyuebaifang","#icon-yuyuebaifang","#icon-shitizu","#icon-shitizu","#icon-jiyidashi","#icon-jiyidashi","#icon-tiaochawenjuan","#icon-tiaochawenjuan","#icon-canfei","#icon-canfei","#icon-baomingfei","#icon-baomingfei","#icon-baoxianfei","#icon-baoxianfei","#icon-jishufuwu","#icon-jishufuwu","#icon-banfei","#icon-banfei","#icon-guiji","#icon-guiji","#icon-gerenzhongxin","#icon-gerenzhongxin","#icon-churumenjin","#icon-churumenjin","#icon-qita","#icon-qita","#icon-kuaisuliulan","#icon-kuaisuliulan","#icon-kaoshifei","#icon-kaoshifei","#icon-shubenfei","#icon-shubenfei","#icon-tongjizhongxin","#icon-tongjizhongxin","#icon-xuexipingjia","#icon-xuexipingjia","#icon-xiaofufei","#icon-xiaofufei","#icon-sheshiweixiufei","#icon-sheshiweixiufei","#icon-yingyong","#icon-yingyong","#icon-zafei","#icon-zafei","#icon-xuefei","#icon-xuefei","#icon-yunwenjian","#icon-yunwenjian","#icon-xiaoxi","#icon-xiaoxi","#icon-yunwenjiandongtai","#icon-yunwenjiandongtai","#icon-zhangdan","#icon-zhangdan","#icon-jiaofeidan","#icon-jiaofeidan","#icon-aixin","#icon-aixin","#icon-baocun","#icon-baocun","#icon-daka","#icon-daka","#icon-bianji","#icon-bianji","#icon-dayin","#icon-dayin","#icon-biaoqian","#icon-biaoqian","#icon-daichuli","#icon-daichuli","#icon-ditu","#icon-ditu","#icon-dianzan","#icon-dianzan","#icon-dingdan","#icon-dingdan","#icon-dianpu","#icon-dianpu","#icon-dingdanbianji","#icon-dingdanbianji","#icon-dingdanchaxun","#icon-dingdanchaxun","#icon-dingwei","#icon-dingwei","#icon-fangyuan","#icon-fangyuan","#icon-fuzhi","#icon-fuzhi","#icon-gaishuai","#icon-gaishuai","#icon-gerenshezhi","#icon-gerenshezhi","#icon-gonglve","#icon-gonglve","#icon-hezuo","#icon-hezuo","#icon-hongbao","#icon-hongbao","#icon-jihua","#icon-jihua","#icon-jiaoxue","#icon-jiaoxue","#icon-lipin","#icon-lipin","#icon-luxiang","#icon-luxiang","#icon-paizhao","#icon-paizhao","#icon-pingtai","#icon-pingtai","#icon-qianbao","#icon-qianbao","#icon-qiehuan","#icon-qiehuan","#icon-renwu","#icon-renwu","#icon-rili","#icon-rili","#icon-rizhi","#icon-rizhi","#icon-shanchu","#icon-shanchu","#icon-shangpin","#icon-shangpin","#icon-shangchuan","#icon-shangchuan","#icon-shenhechenggong","#icon-shenhechenggong","#icon-shenheshibai","#icon-shenheshibai","#icon-shipin","#icon-shipin","#icon-shoucang","#icon-shoucang","#icon-shuoming","#icon-shuoming","#icon-tixian","#icon-tixian","#icon-tonggao","#icon-tonggao","#icon-tongxunlu","#icon-tongxunlu","#icon-tupian","#icon-tupian","#icon-tuandui","#icon-tuandui","#icon-wendang","#icon-wendang","#icon-wenjianjia","#icon-wenjianjia","#icon-xiazai","#icon-xiazai","#icon-xiaoxi1","#icon-xiaoxi1","#icon-xinjian","#icon-xinjian","#icon-xunzhang","#icon-xunzhang","#icon-yaoqing","#icon-yaoqing","#icon-yiduyoujian","#icon-yiduyoujian","#icon-yinle","#icon-yinle","#icon-youhuiquan","#icon-youhuiquan","#icon-youjian","#icon-youjian","#icon-yuyue","#icon-yuyue","#icon-zhinan","#icon-zhinan","#icon-zhuce","#icon-zhuce","#icon-zhuxiao","#icon-zhuxiao","#icon-zixun","#icon-zixun","#icon-zudui","#icon-zudui","#icon-daihuifu","#icon-daihuifu","#icon-chulizhong","#icon-chulizhong","#icon-butongguo","#icon-butongguo","#icon-daihuifu_2","#icon-daihuifu_2","#icon-gongshizhong","#icon-gongshizhong","#icon-daihuifu_1","#icon-daihuifu_1","#icon-shenhezhong","#icon-shenhezhong","#icon-huitui","#icon-huitui","#icon-yihuifu","#icon-yihuifu","#icon-weidu","#icon-weidu","#icon-yidu","#icon-yidu","#icon-weifabu","#icon-weifabu","#icon-shenqingchenggong","#icon-shenqingchenggong","#icon-yihuifu_1","#icon-yihuifu_1","#icon-yibanjie","#icon-yibanjie","#icon-zaizhi","#icon-zaizhi","#icon-yishenqing","#icon-yishenqing","#icon-yishenhe","#icon-yishenhe","#icon-shenqingzhong","#icon-shenqingzhong","#icon-yanzhengshibai","#icon-yanzhengshibai","#icon-1_qiandan-01","#icon-1_qiandan-01","#icon-1_qiandan-11","#icon-1_qiandan-11","#icon-1_qiandan-21","#icon-1_qiandan-21","#icon-1_jifenduihuan-02","#icon-1_jifenduihuan-02","#icon-1_jifenduihuan-12","#icon-1_jifenduihuan-12","#icon-1_jifenduihuan-22","#icon-1_jifenduihuan-22","#icon-1_tequan-03","#icon-1_tequan-03","#icon-1_tequan-13","#icon-1_tequan-13","#icon-1_tequan-23","#icon-1_tequan-23","#icon-1_jiaoyu-04","#icon-1_jiaoyu-04","#icon-1_jiaoyu-14","#icon-1_jiaoyu-14","#icon-1_jiaoyu-24","#icon-1_jiaoyu-24","#icon-1_qianbao-05","#icon-1_qianbao-05","#icon-1_qianbao-15","#icon-1_qianbao-15","#icon-1_qianbao-25","#icon-1_qianbao-25","#icon-1_tuandui-06","#icon-1_tuandui-06","#icon-1_tuandui-16","#icon-1_tuandui-16","#icon-1_tuandui-26","#icon-1_tuandui-26","#icon-1_waimai-07","#icon-1_waimai-07","#icon-1_waimai-17","#icon-1_waimai-17","#icon-1_waimai-27","#icon-1_waimai-27","#icon-1_dache-08","#icon-1_dache-08","#icon-1_dache-18","#icon-1_dache-18","#icon-1_dache-28","#icon-1_dache-28","#icon-1_shucai-09","#icon-1_shucai-09","#icon-1_shucai-19","#icon-1_shucai-19","#icon-1_shucai-29","#icon-1_shucai-29","#icon-1_qianggoumiaosha-10","#icon-1_qianggoumiaosha-10","#icon-1_qianggoumiaosha-20","#icon-1_qianggoumiaosha-20","#icon-1_qianggoumiaosha-30","#icon-1_qianggoumiaosha-30","#icon-1_dianying-31","#icon-1_dianying-31","#icon-1_dianying-41","#icon-1_dianying-41","#icon-1_dianying-51","#icon-1_dianying-51","#icon-1_xinyongka-32","#icon-1_xinyongka-32","#icon-1_xinyongka-42","#icon-1_xinyongka-42","#icon-1_xinyongka-52","#icon-1_xinyongka-52","#icon-1_youhuiquan-33","#icon-1_youhuiquan-33","#icon-1_youhuiquan-43","#icon-1_youhuiquan-43","#icon-1_youhuiquan-53","#icon-1_youhuiquan-53","#icon-1_hongbao-34","#icon-1_hongbao-34","#icon-1_hongbao-44","#icon-1_hongbao-44","#icon-1_hongbao-54","#icon-1_hongbao-54","#icon-1_canyin-35","#icon-1_canyin-35","#icon-1_canyin-45","#icon-1_canyin-45","#icon-1_canyin-55","#icon-1_canyin-55","#icon-1_gouwu-36","#icon-1_gouwu-36","#icon-1_gouwu-46","#icon-1_gouwu-46","#icon-1_gouwu-56","#icon-1_gouwu-56","#icon-1_jiudian-37","#icon-1_jiudian-37","#icon-1_jiudian-47","#icon-1_jiudian-47","#icon-1_huoguo-38","#icon-1_huoguo-38","#icon-1_huoguo-48","#icon-1_huoguo-48","#icon-1_huoguo-58","#icon-1_huoguo-58","#icon-1_huore-39","#icon-1_huore-39","#icon-1_huore-49","#icon-1_huore-49","#icon-1_huore-59","#icon-1_huore-59","#icon-1_lipin-40","#icon-1_lipin-40","#icon-1_lipin-50","#icon-1_lipin-50","#icon-1_lipin-60","#icon-1_lipin-60","#icon-daishenhe","#icon-daishenhe","#icon-chakandingdan","#icon-chakandingdan","#icon-yinhangka","#icon-yinhangka","#icon-touzi-03","#icon-touzi-03","#icon-renwu1","#icon-renwu1","#icon-weixiu","#icon-weixiu","#icon-cunkuan","#icon-cunkuan","#icon-yuangongguanli","#icon-yuangongguanli","#icon-daifukuan","#icon-daifukuan","#icon-gouwuche","#icon-gouwuche","#icon-naozhong","#icon-naozhong","#icon-yue","#icon-yue","#icon-daichuli1","#icon-daichuli1","#icon-dikouquan","#icon-dikouquan","#icon-quanyi","#icon-quanyi","#icon-tuandui1","#icon-tuandui1","#icon-qiyeguanli","#icon-qiyeguanli","#icon-shangchuanwenjian","#icon-shangchuanwenjian","#icon-shanchuwenjian","#icon-shanchuwenjian","#icon-tianqi","#icon-tianqi","#icon-wendang1","#icon-wendang1","#icon-fengxianchaxun","#icon-fengxianchaxun","#icon-miaosha","#icon-miaosha","#icon-tupian1","#icon-tupian1","#icon-dache","#icon-dache","#icon-kafei","#icon-kafei","#icon-niantie","#icon-niantie","#icon-mima","#icon-mima","#icon-jiesuo","#icon-jiesuo","#icon-xitongshezhi","#icon-xitongshezhi","#icon-shoucang1","#icon-shoucang1","#icon-pinglun","#icon-pinglun","#icon-baoxiao","#icon-baoxiao","#icon-lizhi","#icon-lizhi","#icon-ruzhi","#icon-ruzhi","#icon-shezhi","#icon-shezhi","#icon-kaoqinshensu","#icon-kaoqinshensu","#icon-sousuo","#icon-sousuo","#icon-zhanghu","#icon-zhanghu","#icon-duizhang-39","#icon-duizhang-39","#icon-ershouche","#icon-ershouche","#icon-xuanxiang","#icon-xuanxiang","#icon-zixun1","#icon-zixun1","#icon-guanlian","#icon-guanlian","#icon-huishuai","#icon-huishuai","#icon-jiaoseguanli","#icon-jiaoseguanli","#icon-baogao","#icon-baogao","#icon-gonglve1","#icon-gonglve1","#icon-women","#icon-women","#icon-yinliang","#icon-yinliang","#icon-dingwei1","#icon-dingwei1","#icon-tiaoxiu","#icon-tiaoxiu","#icon-jiaban","#icon-jiaban","#icon-qingjia1","#icon-qingjia1","#icon-wendang11","#icon-wendang11","#icon-beifen","#icon-beifen","#icon-bianqian","#icon-bianqian","#icon-kabao","#icon-kabao","#icon-daiban","#icon-daiban","#icon-chongzhi","#icon-chongzhi","#icon-yinliao","#icon-yinliao","#icon-gongwenbao","#icon-gongwenbao","#icon-guanyingjilu","#icon-guanyingjilu","#icon-shexiangtou","#icon-shexiangtou","#icon-yingyin","#icon-yingyin","#icon-wenjian","#icon-wenjian","#icon-gonggao","#icon-gonggao","#icon-jiankong","#icon-jiankong","#icon-daipaidan","#icon-daipaidan","#icon-daijiedan","#icon-daijiedan","#icon-bofang","#icon-bofang","#icon-daifahuo","#icon-daifahuo","#icon-shouhou","#icon-shouhou","#icon-gerenziliao","#icon-gerenziliao","#icon-huiyuanka","#icon-huiyuanka","#icon-guanshui","#icon-guanshui","#icon-jifen","#icon-jifen","#icon-kuaitui","#icon-kuaitui","#icon-kuaijin","#icon-kuaijin","#icon-touzi1","#icon-touzi1","#icon-yingli","#icon-yingli","#icon-jiankong1","#icon-jiankong1","#icon-fenxiang","#icon-fenxiang","#icon-fengxianchaxun1","#icon-fengxianchaxun1","#icon-wenjiandaochu","#icon-wenjiandaochu","#icon-dengji","#icon-dengji","#icon-shoujizhifu","#icon-shoujizhifu","#icon-yunshu","#icon-yunshu","#icon-huiyi","#icon-huiyi","#icon-baogao1","#icon-baogao1","#icon-ziliaofenxiang","#icon-ziliaofenxiang","#icon-duizhang-96","#icon-duizhang-96","#icon-yuyin","#icon-yuyin","#icon-shangjiaruzhu","#icon-shangjiaruzhu","#icon-rizhi1","#icon-rizhi1","#icon-huihua","#icon-huihua","#icon-cunchu","#icon-cunchu","#icon-color-success","#icon-color-success","#icon-color-error","#icon-color-error","#icon-color-notice","#icon-color-notice","#icon-color-warning","#icon-color-warning","#icon-color-wait","#icon-color-wait","#icon-color-add","#icon-color-add","#icon-color-forbidden","#icon-color-forbidden","#icon-color-reduce","#icon-color-reduce","#icon-color-question","#icon-color-question","#icon-color-question-notice","#icon-color-question-notice","#icon-color-question-error","#icon-color-question-error","#icon-color-nophoto","#icon-color-nophoto","#icon-color-photo","#icon-color-photo","#icon-color-user-m","#icon-color-user-m","#icon-color-user","#icon-color-user","#icon-color-user-s","#icon-color-user-s","#icon-color-nouser","#icon-color-nouser","#icon-color-authority-success","#icon-color-authority-success","#icon-color-authority","#icon-color-authority","#icon-color-pay","#icon-color-pay","#icon-color-pay-success","#icon-color-pay-success","#icon-color-protect-success","#icon-color-protect-success","#icon-color-protect-error","#icon-color-protect-error","#icon-color-protect-notice","#icon-color-protect-notice","#icon-Excel","#icon-Excel","#icon-File","#icon-File","#icon-Word","#icon-Word","#icon-PPT","#icon-PPT","#icon-music","#icon-music","#icon-chengxu","#icon-chengxu","#icon-shipin1","#icon-shipin1","#icon-lianjiewenjian","#icon-lianjiewenjian","#icon-tupian2","#icon-tupian2","#icon-yasuobao","#icon-yasuobao","#icon-weizhiwenjian","#icon-weizhiwenjian","#icon-Gif","#icon-Gif","#icon-Exe","#icon-Exe","#icon-Pdf","#icon-Pdf","#icon-txt1","#icon-txt1","#icon-WPS","#icon-WPS","#icon-shujuku2","#icon-shujuku2","#icon-shujuku","#icon-shujuku","#icon-a-3D","#icon-a-3D","#icon-youjian1","#icon-youjian1","#icon-peizhiwenjian","#icon-peizhiwenjian","#icon-wode","#icon-wode","#icon-shouye","#icon-shouye","#icon-gerenziliao1"];

    let resultArr = Array.from(new Set(arr))

    field.iconpicker({
        placement:'bottomLeft',
        animation: false,
        icons:resultArr,
        fullClassFormatter:function(a) {
            return a;
        },
        templates: {
            iconpickerItem: '<a role="button" href="#" class="iconpicker-item"><i></i><svg class="icon" aria-hidden="true"><use xlink:href></use></svg></a>'
        }
    });

    parent.find('.iconpicker-item').on('click', function (e) {
       showIcon($(this).find('use').attr('xlink:href'));
    });

    field.on('keyup', function (e) {
        var val = $(this).val();
        showIcon(val);
    })
}, 1);
JS;
    }

}
